### NAT
NAT 는 네트워크 주소를 변환하는 기술이다.<br>
기본적으로 1:1 변환이 기본이지만 PAT 기술을 통해 1:N 변환이 가능하다 <br>

보통 NAT 기술은 사설 IP 주소 -> 공인 IP 주소로 전환하는 경우가 대부분이다<br>

1) NAT 는 Ipv4 주소 고갈문제의 솔루션으로 사용된다.
2) NAT 는 보안을 강화하는데 사용된다.
3) IP 주소 쳬계가 같은 두 개의 네트워크 간 통신을 가능하게 해준다.
4) 불필요한 설정 변경을 줄일 수 있다.

SNAT 는 사설 IP 에서 공인 IP 로 통신할 때 많이 사용한다 <br>

DNAT 는 로드 밸런서에서 많이 사용한다 <br>

### DNS
네트워크 프로토콜은 크게 두가지로 나뉠 수 있다<br>
실제로 데이터를 실어나르는 데이터 프로토콜, 이 데이터 프로토콜이 잘 동작하도록 도와주는 컨트롤 프로토콜 이다 <br>

컨트롤 프로토콜은 통신에 직접 관여하지는 않지만, 처음 통신 관계를 맺거나 유지하는 데 큰 도움을 준다 <br>
TCP/IP 프로토콜 체계를 유지하기 위한 주요 컨트롤 프로토콜은 ARP, ICMP, DNS 가 있다 <br>

이 중 DNS 는 도메인 주소를 IP 주소로 변환하는 역할을 한다 <br>
IP 주소 보다 도메인 주소를 이용하는 것이 일반 사용자에게 더 익숙하고 서버 IP 변경에 쉽게 대처할 수 있으므로 네트워크 통신에서 DNS 의 역할이 매우 중요하다 <br>

요즘은 클라우드 기반 인프라 구성이 많아지면서 인프라가 빈번히 변경되어 DNS 설계가 더 중요해지고 있다 <br>
또한 MSA 기반의 설계가 많아지면서 다수의 API 를 이용하다본 사용자의 호출뿐만 아니라 서비스 간 API 호출이나 인터페이스가 많아져 DNS 역할은 더 중요해졌다 <br>

어떠한 사이트를 이용하더라도 우리는 알게 모르게 IP 주소를 이용하고 있습니다 <br>
사용자는 도메인 주소도 알기 어려운데, 만약 도메인주소가 없다면? IP 주소 12자리를 외우고 있어야 합니다 <br>

숫자로 구성된 IP 주소보다, 문자로 구성된 도메인 주소가 인식하기 편하다 <br>

#### DNS 구조와 명명 규칙
도메인은 계층 구조여서 수많은 인터넷 주소 중 원하는 주소를 효율적으로 찾아갈 수 있다 <br>
www.naver.com 은 <br>
- www : Third-Level Domain
- naver : Second-Level Domain
- com : Top-Level Domain
- com 뒤에는 루트가 있다

위 도메인에서 루트부터 반대 순서로 찾아간다. 즉 서버가 읽을 떄는 com.naver.www 순으로 읽게 된다 <br>

#### 루트 도메인
도메인을 구성하는 최상위 영역이다 <br>
DNS 서버는 사용자가 쿼리한 도메인에 대한 값을 직접 갖고 있거나 캐시에 저장된 정보를 이용해 응답한다 <br>

#### Top-Level Domain
최상위 도메인인 TLD 는 IANA 에서 구분한 6가지 유형으로 구분할 수 있다 <br>
ex) gTLD -> com,net,org etc..<br>

### DNS 동작 방식
도메인을 IP 주소로 변환하려면 DNS 서버에 도메인 쿼리하는 과정을 거쳐야 한다 <br>
하지만 DNS 서버 없이 로컬에 도메인과 IP 주소를 직접 설정해 사용할 수도 있다 <br>

로컬에서 도메인과 IP 주소를 관리하는 파일을 Hosts 파일 이라고 한다 <br>
host 파일에 도메인과 IP 주소를 설정해두면 해당 도메인 리스트는 항상 DNS 캐시에 저장된다 <br>

1) 도메인을 쿼리하면 DNS 서버에 쿼리를 하기 전 로컬 DNS 캐시 정보를 먼저 체크한다 <br>
즉 www.naver.com 으로 요청이오면 로컬DNS캐시 체크 후 캐시가 있으면 그 정보를 바탕으로 바로 응답, 아니면 DNS 서버로 전송 <br>


#### 마스터와 슬레이브
DNS 서버는 마스터 서버와 슬레이브 서버로 나눌 수 있다 <br>
마스터와 슬레이브는 도메인에 대한 존파일을 직접 관리하는지 여부로 구분한다 <br>

DNS 마스터/슬레이브는 보통 이중화 서버에서 사용하는 액티브-스탠바이나, 액티브-액티브 형태로 구성하지 않는다<br>
* 마스터 서버는 모든 도메인에 대해 마스터로 설정하고, 슬레이브 서버는 모두 슬레이브로 설정하는 것이 관리상 바람직하다 <br>

> 액티브-스탠바이, 액티브-액티브
> > 서비스 일부가 장애가 생겨도 서비스가 지속될 수 있도록 고가용성 기술을 사용하는데, 고가용성을 위해 일반적으로 사용하는 구조가 액티브-액티브, 액티브-스탠바이 이다 <br>
> 액티브-액티브 : 2개의 노드가 동시에 서비스를 제공하고, 한 노드에 문제가 생기면 다른 노드에서 서비를 계속 제공한다. <br>
> 액티브-스탠바이 : 두개의 노드중 액티브 노드만 서비스를 제공하고, 스탠바이 노드는 대기하다 장애가 생기면 대신 서비를 시작한다.

2가지 서버가 동시에 죽지만 않으면 정상적으로 서비스는 동작한다 <br>

#### DNS 주요 레코드
도메인에는 다양한 내용을 매핑할 수 있는 레코드가 있다<br>

- A 레코드 : 도메인 주소를 Ipv4 로 매핑
A 레코드는 기본 레코드로 도메인 주소를 IP 주소로 변환하는 레코드 입니다 <br>
사용자가 DNS 에 질의한 도메인 주소를 A 레코드에 설정된 IP 주소로 응답한다 <br>
하나의 A 레코드에는 한 개의 도메인 주소와 한 개의 IP 주소가 1:1 로 매핑되는데 동일한 도메인을 가진 A 레코드를 여러개 만들어 서로 다른 IP 주소와 매핑할 수도 있다 <br>
반대로 다수의 도메인에 여러 IP 를 매핑한 A 레코드도 있다 <br>

서버 한 대에 여러 웹 서비스를 구동해야 한다면 여러 도메인에 동일한 IP 를 매핑하고 Http 헤더의 Host 필드에 도메인을 명시해 웹 서버를 구분해 서비스 할 수 있다 <br>

- AAAA : Ipv6 레코드
- CNAME : 별칭 이름을 사용하게 해주는 레코드
  - 레코드 값에 IP 주소를 매핑하는 A 레코드와 달리 CNAME 레코드는 도메인 주소를 매핑한다.
  - CNAME 레코드의 대표적인 예로 'www' 가 있다.
- SOA : 도메인 영역에 대한 권한을 나타내는 레코드
- NS : 도메인에 대한 권한이 있는 네임 서버 정보를 설정하는 레코드
- MX : 메일 서버를 구성할 때 사용되는 레코드

#### DNS 키워드
- 도메인 위임
- TTL
- 화이트 도메인
- 한글 도메인

### GSLB
DNS 에서 동일한 레코드 이름으로 서로 다른 IP 주소를 동시에 설정할 수 있다 <br>
이렇게 설정하면 도메인 질의에 따라 응답받는 IP 주소를 나누어 로드밸런싱 할 수 있다 <br>

GSLB 는 도메인을 이용한 로드밸런싱 구현을 도와줍니다 <br>

### DHCP
수동으로 IP 와 네트워크 정ㅈ보를 직접 설정하는 것을 '정적 할당' 이라고 하고 자동으로 설정하는것을 '동적 할당' 이라고 한다 <br>
IP 를 동적으로 할당하는데 사용되는 프로토콜이 바로 DHCP 입니다 <br>

#### DHCP 프로토콜
DHCP 는 BOOTP 라는 프로토콜을 기반으로 작동한다 <br>

DHCP 는 서버와 클라이언트로 동작하며 클라이언트의 서비스 포트는 68, 서버이 서비는 포트는 67 이다 <br>

- DHCP 동작방식
  - DHCP Discover
  - DHCP Offer
  - DHCP Request
  - DHCP Acknowledgement