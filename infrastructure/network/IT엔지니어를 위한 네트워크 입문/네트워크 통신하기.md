# 네트워크 통신하기
네트워크가 출발지에서 목적지로 데이터를 전송할 때 사용하는 통신 방식에는 여러가지가 있다 <br>
- 유니캐스트 : 1:1 통신
- 브로드캐스트 : 1:N 통신, 동일 네트워크에 존재하는 모든 호스트가 목적지
- 멀티캐스트 : 1:N(그룹) 통신
- 애니캐스트 : 1:1 통신

우리가 실제로 사용하는 대부분의 통신은 유니캐스트 방식을 사용한 http 1:1 통신이라고 생각하면 된다 <br>

### MAC 주소
media access control 2계층(데이터 링크) 에서 통신을 위해 네트워크 인터페이스에 할당된 고유 식별자 이다 <br>
네트워크에 접속하는 모든 장비는 MAC 주소라는 물리적인 주소가 필수적으로 있어야하고 이 주소를 통해 서로 통신한다 <br>

#### MAC 주소체계
MAC 주소는 한번 할당받으면 하드웨어에 고정되어, 변경하기 어렵다 <br>
하지만 운영체제 에 따라 변경이 가능하기도 하다 ex)Linux, windows <br>
MAC 주소는 48비트의 16진수 12자리로 표현이 된다 <br>
그 중에서 앞 6자리는 제조사 코드, 뒤 6자리는 제조사에서 할당한 네트워크 값 이다 <br>
> 12:c1:c2:78:a1:12

위 처럼 구성이 되어 있다 <br>

### IP 주소
OSI7계층에서 주소를 갖는건 2계층과 3계층이다 <br>
2계층은 물리 주소인 MAC 주소를 가지고, 3계층은 논리 주소인 IP 주소를 가진다 <br>
대부분의 네트워크는 TCP/IP 로 동작하므로 IP 주소 체계를 이해하는 것이 중요하다 <br>

논리 주소인 IP 주소는 사용자가 변경이 가능하고 <br>
주소에 레벨이 있어, 네트워크 주소, 호스트 주소로 나뉜다 <br>
우리가 흔히 사용하는 IP 는 32비트를 가진 IPv4 이다, 128비트의 Ipv6 도 있다 <br>
IP 주소는 10진수로 표기하며 아래와 같다 <br>
> 127.0.0.1 

127 은 11000000 을 가진 8비트이다. <br>

IP 주소 체계는 필요한 호스토 IP 개수에 따라 네트워크의 크기를 다르게 할당할 수 있는 클래스 개념을 도입했다 <br>
- A 클래스 : 1600만개 대략(2^24)
- B 클래스 : 6만5천개(2^16)
- C 클래스 : 250개(2^8)
- D 클래스 : 멀티 캐스트
- E 클래스 : 예약

클래스를 구분하는 방법은
- 1 ~ 127.0.0.0 -> A 클래스
- 128 ~ 191.0.0.0 -> B 클래스
- 192 ~ 223.0.0.0 -> C 클래스
- 224 ~ 239.0.0.0 -> D 클래스

로 대역폭을 보고 구별할 수가 있다 <br>

IP 주소에서 맨 앞의 숫자를 네트워크 주소, 맨 뒤 숫자를 브로드캐스트 주소로 사용하기에 혹시라도 사용가능한 IP 개수를 찾을 땐 -2 를 해줘야한다 <br>

IP 주소가 많아 짐에 따라 새로운 개념이 도입이 되었는데 그게 바로 클래스리스 네트워크이다 <br>
이 네트워크에는 서브넷 마스크를 도입했다 <br>
> 255.255.255.255

서브넷 마스크는 IP 주소와 네트워크 주소를 구분할 때 사용하는데 2진수 숫자 1은 네트워크 주소, 0 은 호스트 주소를 의미한다 <br>
(호스트주소+서브넷마스크) 한쌍이고, 네트워크 주소 는 별개로 구분이 된다고 보면 된다 <br>

### TCP 와 UDP
2,3계층은 목적지를 정확히 찾아가기 위한 것이 목적이였다 <br>
4계층에서 동작하는 TCP/UDP 프로토콜은 위 목적과는 조금 다르다 <br>

위 프로토콜들은 애플리케이션 통신 중 목적지를 잘 찾아갈수 있게 도와주는 역할을 한다 <br>

TCP 프로토콜에서는 패킷을 분할하고 조합하기 위해 시퀀스 번호와 ACK 번호를 사용한다 <br>

일반적으로 TCP/IP 에서는 클라이언트-서버 방식으로 서비스를 제공하고 클라이언트용 프로그램과 서버용 프로그램을 구분해 개발한다 <br>

### TCP
TCP 프로토콜은 신뢰할 수 없는 공용망에서도 정보유실 없는 통신을 보장하기 위해 세션을 안전하게 연결하고 데이터를 분할하고 분할된 패킷이 잘 전송되었는지 확인하는 기능이 있다 <br>
패킷에 번호를 부여하고 잘 전송되었는지에 대해 응답한다 <br>

#### 패킷 순서, 응답 번호
TCP 에서는 패킷에 순서를 부여하는 시퀀스 번호, 응답 번호를 부여는 ACK 번호가 있다 <br>
두 번호가 상호작용해 순서가 바뀌거나 중간에 패킷이 손실된 것을 파악할 수 있다<br>

네트워크 거리가 멀면 효율을 위해 한꺼번에 많은 패킷을 보내는게 좋다 <br>
하지만 그 만큼 네트워크 상태가 안좋으면 패킷 유실 가능성이 커지므로 적절한 송신량을 결정해야 한다 <br>

한번에 받을 수 있는 데이터 크기 '**윈도 사이즈**', 윈도 사이즈 조절하는 것을 '**슬라이딩 윈도우**' 라고 한다 <br>
TCP 헤더에서 윈도 사이즈로 표현할 수 있는 최대 크기는 2^16 이다 <br>

#### 3Way HandShake
TCP 에서는 유실없는 송수신을 위해 통신 시작 전, 사전 연결작업을 진행한다 <br>
TCP 에서는 3번의 패킷을 주고 받으며, 통신을 서로 준비하므로 3 way handshake 라고 부른다 <br>

### UDP
4계층에서는 신뢰성있는 통신을 위해 3way handshake 을 하였다 <br>
UDP 에는 위 기능이 전혀 없다 <br>

보통 신뢰성 보다 일부 데이터가 유실되더라도 시간에 맞추어 계속 전송을 하는 것이 중요한 <br>
실시간과 관련된 스트리밍, 동영상, 화상회의 시스템과 같은 경우 UDP 프로토콜을 많이 사용한다 <br>
참고* 유튜브,넷플릭스는 TCP 를 사용한다<br>

UDP 는 데이터가 유실되어도 그냥 유실된 상태로 데이터를 처리해버린다 <br>

### ARP
실제 통신은 IP 주소 기반으로 일어나고 MAC 주소는 상대방의 주소를 자동으로 알아내 통신하게 된다 <br>
이때 상대방의 MAC 주소를 알아내기 위해 사용되는 프로토콜이 ARP 라고 한다 <br>

IP 주소와 MAC 주소는 전혀 연관성이 없으므로 두 개의 주소를 연계시켜 주기 위한 메커니즘이 필요하다 <br>

일반적인 ARP 외에도, GARP, RARP 라는 프로토콜도 존재한다 <br>
- GARP : 자신의 IP 주소 및 MAC 주소를 알리기 위한 용도
- RARP : 자신의 MAC 주소는 알지만, IP 를 모를 때 IP 주소를 알기 위한 프로토콜

### 서브넷과 게이트웨이
원격지 네트워크와 통신에 사용하는 장비를 게이트웨이 라고 하며, 3계층 장(라우터, L3 스위치) 가 이 역할을 할 수 있다 <br>
ARP 브로드캐스트는 원격 네트워크가 불가하므로, 게이트웨이 장비를 사용해야 한다 <br>